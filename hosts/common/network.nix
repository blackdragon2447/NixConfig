{...}: {
  services.resolved = {
    enable = true;
    dnsovertls = "true";
    dnssec = "true";
    domains = ["~."];
    fallbackDns = ["9.9.9.9" "149.112.112.112" "2620:fe::fe" "2620:fe::9"];
  };

  networking = {
    nameservers = ["9.9.9.9" "149.112.112.112" "2620:fe::fe" "2620:fe::9"];

    networkmanager.dns = "systemd-resolved";

    firewall = {
      enable = true;
      allowedTCPPortRanges = [
        {
          from = 1714;
          to = 1764;
        } # KDE Connect
      ];
      allowedUDPPortRanges = [
        {
          from = 1714;
          to = 1764;
        } # KDE Connect
      ];
    };
  };
}
